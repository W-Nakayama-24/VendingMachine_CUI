:lang: ja
:doctype: book
:toc: left
:toclevels: 3
:toc-title: 目次
//toc: 目次を生成
:sectnums:
:sectnumlevels: 4
:sectlinks:
:imagesdir: ./_images
//画像イメージのディレクトリを指定 (NOTEやTIPのマークを持ってくる)
:icons: font
:source-highlighter: coderay 
//coderay: コード部分をハイライトさせる gem install coderay
:example-caption: 例
:table-caption: 表
:figure-caption: 図
:docname: = asciidoc-自販機システム_ユースケース記述
:author: Nakayama
:revnumber: 0.2
:revdate: 2019/10/16

= 自販機システム-機能仕様

== システム概要
'''

この自販機システムは、コンソール上で数字および文字列の入力を受け付ける。 + 
自販機システムが実現する基本的な機能は以下の通りである。

====
. 規定された数字の入力を「投入金額」としてシステム上に保持する。
. 入力された商品名に応じて商品(飲み物)を提供し、商品の単価分だけ投入金額を減らす。
. ユーザーが「返金を受け取る」機能を文字列入力で呼び出した場合、残っている投入金額を返却する
====

== 自販機システムのユースケース
'''
自販機システムが実現する機能を3つのユースケースに分類し、以下の図に表した。

image::https://raw.githubusercontent.com/W-Nakayama-24/VendingMachine_CUI/5f080bf1ca268846186af8fccd6b8a5f3d63561f/UseCase/%E8%87%AA%E8%B2%A9%E6%A9%9F%E3%82%B7%E3%82%B9%E3%83%86%E3%83%A0_%E3%83%A6%E3%83%BC%E3%82%B9%E3%82%B1%E3%83%BC%E3%82%B9%E5%9B%B3.png[diagram]

== 機能詳細
'''

=== システム始動

[cols="1a,3a"]
|===
|**ユースケースID**
|該当なし (CUIが実現する機能である為、ユースケースに含めない)

|**ユースケース名称**
|システム始動

|**概要**
|初期画面の表示

|**優先度**
| -

|**アクター**
|利用者

|**トリガー**
|自販機システムの実行ファイルを指定・実行

|**事前条件**
|なし

|**基本フロー**
|
. 自販機システムの実行ファイルを指定してプログラムを実行する
. 初期画面が表示される。
. シナリオを終了する。

|**代替フロー**
|なし

|**例外フロー**
|なし

|**事後条件**
|初期画面が表示されている

|**補足**
|初期画面のイメージは以下の通りである
....
   商品名     / 価格   / 在庫
● おいしい水   / 100円 / 残り12本
● サイコソーダ / 150円 / 残り5本
● ミックスオレ / 160円 / 残り0本


投入金額 [   0]円


1000, 500, 100, 50, 10 : お金を投入する
商品名を入力            : 商品を購入する
[R]キーを入力           : お金の返却 
....
|===

=== お金を投入する

[cols="1a,3a"]
|===
|**ユースケースID**
|UC01

|**ユースケース名称**
|お金を投入する

|**概要**
|利用者がコンソールで入力した金額を自販機システムの残高に加算する。

|**優先度**
|MUST

|**アクター**
|利用者

|**トリガー**
|コンソール上で 1000, 500, 100, 50, 10 のいずれかを入力する

|**事前条件**
|初期画面がコンソールに表示されている

|**基本フロー**
|
. 利用者はコンソール上で 1000, 500, 100, 50, 10 のいずれかを入力する。
. 自販機システムは入力された金額を残高に加算する。
. 自販機システムは加算後の残高を初期画面に表示する
. シナリオを終了する。

|**代替フロー**
|
. コンソールの入力内容が 1000, 500, 100, 50, 10 以外の数字だった場合
** エラーメッセージ01をコンソールに表示する 

|**例外フロー**
|なし

|**事後条件**
|初期画面が表示されている

|**補足**
|

(例)基本フロー: 1000 を入力する場合

. 利用者がコンソール上で 1000 を入力する
+
....
   商品名     / 価格   / 在庫
● おいしい水   / 100円 / 残り12本
● サイコソーダ / 150円 / 残り5本
● ミックスオレ / 160円 / 残り0本


投入金額 [   0]円


1000, 500, 100, 50, 10 : お金を投入する
商品名を入力            : 商品を購入する
[R]キーを入力           : お金の返却 

> 1000
....
+
. 自販機システムは入力された金額を残高に加算する。
. 自販機システムは加算後の残高を初期画面に表示する
+
....
   商品名     / 価格   / 在庫
● おいしい水   / 100円 / 残り12本
● サイコソーダ / 150円 / 残り5本
● ミックスオレ / 160円 / 残り0本


投入金額 [1000]円


1000, 500, 100, 50, 10 : お金を投入する
商品名を入力            : 商品を購入する
[R]キーを入力           : お金の返却 
....

エラーメッセージ01
....
ERROR_01:投入金額が正しくありません
1000, 500, 100, 50, 10 のいずれかを入力してください
....

|===

=== 商品を購入する

[cols="1a,3a"]
|===
|**ユースケースID**
|UC02

|**ユースケース名称**
|商品を購入する

|**概要**

|利用者がコンソールで商品名を入力すると、
自販機システムは対応する商品の在庫を減らし、
購入完了を示すシステムメッセージ00を表示する

|**優先度**
|MUST

|**アクター**
|利用者

|**トリガー**
|コンソール上で商品名を入力する

|**事前条件**
|初期画面がコンソールに表示されている

|**基本フロー**
|
. 利用者はコンソール上で商品名を入力する。
. 自販機システムは入力に対応した商品の在庫を1減らす。
. 自販機システムは入力に対応した商品の単価分だけ投入金額を減らす。
. 購入完了を示すシステムメッセージ01を表示する

|**代替フロー**
|
. コンソールの入力内容が存在しない商品名など、不適切な文字列だった場合
** エラーメッセージ02をコンソールに表示する

. 入力された商品名に対応する商品の値段が、入力時点での投入金額を上回っている場合
** エラーメッセージ03をコンソールに表示する

. 入力された商品名に対応する商品の在庫が「残り0本」であった場合
** エラーメッセージ04をコンソールに表示する

|**例外フロー**
|なし

|**事後条件**
|初期画面が表示されている

|**補足**
|システムメッセージ01は以下の通りである

....
--お買い上げありがとうございます--
[商品名]を購入しました
お釣りの取り忘れにご注意ください([R]キーを入力:お金の返却)
....

エラーメッセージ02
....
ERROR_02:存在しない商品名です
正しく入力してください
....

エラーメッセージ03
....
ERROR_03:投入金額が不足しています
お金を追加してください(1000, 500, 100, 50, 10)
....

エラーメッセージ04
....
ERROR_04:ご指定の商品は売り切れています
....

|===

=== 返金を受け取る

[cols="1a,3a"]
|===
|**ユースケースID**
|UC03

|**ユースケース名称**
|返金を受け取る

|**概要**
|

利用者がコンソールで「R」を入力すると、
自販機システムは入力時点で投入されている金額を
返却したことを示すシステムメッセージ00を表示し、
初期画面に表示されている投入金額は0円に戻る

|**優先度**
|MUST

|**アクター**
|利用者

|**トリガー**
|コンソール上で「R」を入力する

|**事前条件**
|初期画面がコンソールに表示されている

|**基本フロー**
|
. 利用者はコンソール上で「R」を入力する。
. 自販機システムは入力時点で投入されている金額を含めたシステムメッセージ02を表示する。
. 自販機システムは初期画面に表示されている投入金額を0円に戻す

|**代替フロー**
|
. 投入金額が0円のときにコンソール上で「R」の入力があった場合
** エラーメッセージ05をコンソールに表示する


|**例外フロー**
|なし

|**事後条件**
|初期画面が表示されている

|**補足**
|システムメッセージ02は以下の通りである

....
[入力時点の投入金額]円を返却しました 
....

エラーメッセージ05
....
ERROR_05:返却できるお金がありません
お金を追加してください(1000, 500, 100, 50, 10)
....

|===